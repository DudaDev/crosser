{"version":3,"sources":["webpack:///webpack/bootstrap 0c400da4f110b97343d3","webpack:///./lib/crosser.js","webpack:///./lib/modules/promise/native-promise.js","webpack:///./lib/modules/crosser/get-crosser-class.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;;;;;;;;wDCtCoB,CAAkC;;;;0DAC1B,CAAqC;;;;AAEjE,KAAI,OAAO,GAAG,gDAAgB;AAC7B,SAAO,0CAAS;EAChB,CAAC,CAAC;;AAEH,KAAI,MAAM,EAAE;AACX,QAAM,CAAC,OAAO,GAAG,OAAO,CAAC;EACzB;;sBAEc,OAAO;;;;;;;;;;;;sBCXP,OAAO;;;;;;;;;;;;;;;;;sBCAP,UAAS,OAAO,EAAC;AAC/B,MAAI,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;;AAE9B,WAAS,UAAU,GAAG;AACrB,UAAO,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,QAAQ,EAAE,CAAC;GACvC;;MAEK,OAAO;AAED,YAFN,OAAO,CAEA,gBAAgB,EAAE,MAAM,EAAE;0BAFjC,OAAO;;;AAIX,QAAI,CAAC,gBAAgB,GAAG,EAAE,CAAC;AAC3B,QAAI,CAAC,UAAU,GAAG,EAAE,CAAC;AACrB,QAAI,CAAC,iBAAiB,GAAG,gBAAgB,CAAC;AAC1C,QAAI,CAAC,YAAY,GAAG,MAAM,IAAI,GAAG,CAAC;AAClC,QAAI,CAAC,GAAG,GAAG,UAAU,EAAE,CAAC;AACxB,QAAI,CAAC,OAAO,GAAG,EAAE,CAAC;;AAElB,QAAI,CAAC,IAAI,CAAC,iBAAiB,IAAI,CAAC,IAAI,CAAC,iBAAiB,CAAC,WAAW,EAAE;AACnE,WAAM,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC;KACrD;;AAED,UAAM,CAAC,gBAAgB,CAAC,SAAS,EAAE,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,KAAK,CAAC,CAAC;IAC1E;;gBAhBI,OAAO;;WAkBE,wBAAC,KAAK,EAAE;AACrB,SAAI,OAAO,GAAG,KAAK,CAAC,IAAI;SACvB,eAAe,GAAG,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;;AAEtD,SAAI,CAAC,eAAe,IAAI,CAAC,OAAO,EAAE;AACjC,aAAO;MACP;;AAED,SAAI,OAAO,CAAC,IAAI,KAAK,OAAO,EAAE;AAC7B,UAAI,OAAO,CAAC,SAAS,IAAI,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;AACzD,WAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC;OACtB;MACD,MAAM;AACN,UAAI,OAAO,CAAC,WAAW,IACtB,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,WAAW,CAAC,IAC1C,OAAO,CAAC,OAAO,KAAK,IAAI,CAAC,GAAG,EAAE;;AAE9B,WAAI,CAAC,UAAU,CAAC,KAAK,CAAC,CAAC;OACvB,MAAM,IACN,OAAO,CAAC,WAAW,IACnB,OAAO,CAAC,OAAO,KAAK,IAAI,CAAC,GAAG,EAAE;;AAE9B,WAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;OAC7B;MACD;KACD;;;WAEc,yBAAC,WAAW,EAAE;AAC5B,SAAI,GAAG,GAEL,WAAW,KAAK,IAAI,CAAC,YAAY,IAEhC,IAAI,CAAC,YAAY,KAAK,GAAG,IACzB,MAAM,CAAC,QAAQ,CAAC,MAAM,KAAK,WAE5B,CAAC;AACH,YAAO,GAAG,CAAC;KACX;;;WAES,oBAAC,KAAK,EAAE;AACjB,SAAI,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC;AACzB,SAAI,OAAO,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC;AACjE,SAAI,MAAM,GAAG,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC;;AAE/D,SAAI,CAAC,aAAa,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;;AAExC,SAAI,OAAO,CAAC,KAAK,EAAE;AAClB,YAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;MACtB,MAAM;AACN,aAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;MACzB;KACD;;;WAEe,0BAAC,KAAK,EAAE;AACvB,SAAI,OAAO,GAAG,KAAK,CAAC,IAAI;SACvB,WAAW,GAAG,OAAO,CAAC,WAAW,CAAC;;AAEnC,WAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,UAAS,YAAY,EAAE;AAC9E,UAAI,cAAc,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;AACjF,UAAI,cAAc,IAAI,cAAc,CAAC,IAAI,EAAE;AAC1C,qBAAc,CAAC,IAAI,CAAC,WAAS,eAAe,EAAE;AAC7C,YAAI,CAAC,WAAW,CAAC;AAChB,oBAAW,EAAE,WAAW;AACxB,gBAAO,EAAE,eAAe;AACxB,gBAAO,EAAE,OAAO,CAAC,OAAO;SACxB,CAAC,CAAC;QACH,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;OACd,MAAM;AACN,WAAI,CAAC,WAAW,CAAC;AAChB,mBAAW,EAAE,WAAW;AACxB,eAAO,EAAE,cAAc;AACvB,eAAO,EAAE,OAAO,CAAC,OAAO;QACxB,CAAC,CAAC;OACH;MACD,EAAE,IAAI,CAAC,CAAC;KAET;;;WAEU,qBAAC,OAAO,EAAE;AACpB,SAAI,CAAC,iBAAiB,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,CAAC,CAAC;KAC/D;;;WAEY,uBAAC,WAAW,EAAE;AAC1B,SAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC,OAAO,GAAG,IAAI,CAAC;AAClD,YAAO,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC,OAAO,CAAC;AAClD,SAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC,MAAM,GAAG,IAAI,CAAC;AACjD,YAAO,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC,MAAM,CAAC;AACjD,SAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC;AAC1C,YAAO,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,CAAC;KAC1C;;;WAEM,mBAAG;AACT,WAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,CAAC;AACnE,WAAM,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAgB,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,EAAE,IAAI,CAAC,CAAC;AAC3E,SAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC;AAC9B,SAAI,CAAC,YAAY,GAAG,IAAI,CAAC;AACzB,SAAI,CAAC,GAAG,GAAG,IAAI,CAAC;KAChB;;;WAEM,iBAAC,WAAW,EAAE,OAAO,EAAE;AAC7B,SAAI,OAAO,CAAC;;AAEZ,SAAI,IAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,EAAE;AACvC,YAAM,IAAI,KAAK,CAAC,0BAA0B,GAAG,WAAW,GAAG,iBAAiB,CAAC,CAAC;MAC9E;;AAED,YAAO,GAAG,IAAI,OAAO,CAAC,WAAS,OAAO,EAAE,MAAM,EAAE;AAC/C,UAAI,CAAC,gBAAgB,CAAC,WAAW,CAAC,GAAG;AACpC,cAAO,EAAE,OAAO;AAChB,aAAM,EAAE,MAAM;OACd,CAAC;MACF,EAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;;AAEd,SAAI,CAAC,WAAW,CAAC;AAChB,iBAAW,EAAE,WAAW;AACxB,aAAO,EAAE,OAAO;AAChB,aAAO,EAAE,IAAI,CAAC,GAAG;MACjB,CAAC,CAAC;;AAEH,YAAO,OAAO,CAAC;KACf;;;WAEI,eAAC,WAAW,EAAE;AAClB,SAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC;KAChC;;;WAEQ,mBAAC,WAAW,EAAE,QAAQ,EAAE;AAChC,SAAI,YAAY,GAAG,UAAU,EAAE,CAAC;;AAEhC,SAAI,CAAC,UAAU,CAAC,WAAW,CAAC,GAAG,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC;AAClE,SAAI,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;AAC/D,YAAM,IAAI,KAAK,CAAC,cAAc,GAAG,WAAW,GAAG,iCAAiC,CAAC,CAAC;MAClF;;AAED,SAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,GAAG,QAAQ,CAAC;AACtD,YAAO,YAAY,CAAC;KACpB;;;WAEU,qBAAC,WAAW,EAAE,YAAY,EAAE;AACtC,SAAI,CAAC,YAAY,EAAE;AAClB,YAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC,CAAC;MAClG,MAAM;AACN,UAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC;AAClD,aAAO,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC,YAAY,CAAC,CAAC;MAClD;KACD;;;WAEQ,mBAAC,KAAK,EAAE;AAChB,SAAI,OAAO,GAAG,KAAK,CAAC,IAAI,CAAC;;AAEzB,SAAI,CAAC,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,UAAS,QAAQ,EAAE;AAC1D,cAAQ,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;MAC1B,CAAC,CAAC;KACH;;;WAEa,wBAAC,SAAS,EAAE,QAAQ,EAAE;AACnC,SAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC;AACxD,SAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;KACvC;;;WAEe,0BAAC,SAAS,EAAE;AAC3B,SAAI,CAAC,OAAO,CAAC,SAAS,CAAC,GAAG,IAAI,CAAC;AAC/B,YAAO,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;KAC/B;;;WAEW,sBAAC,SAAS,EAAE,OAAO,EAAE;AAChC,SAAI,CAAC,WAAW,CAAC;AAChB,eAAS,EAAE,SAAS;AACpB,UAAI,EAAE,OAAO;AACb,aAAO,EAAE,OAAO;AAChB,aAAO,EAAE,IAAI,CAAC,GAAG;MACjB,CAAC,CAAC;KACH;;;UA9LI,OAAO;;;AAiMb,SAAO,OAAO,CAAC;EAEf","file":"./crosser.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 0c400da4f110b97343d3\n **/","import Promise from './modules/promise/native-promise';\nimport getCrosserClass from './modules/crosser/get-crosser-class';\n\nvar Crosser = getCrosserClass({\n\tPromise: Promise\n});\n\nif (window) {\n\twindow.Crosser = Crosser;\n}\n\nexport default Crosser;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./lib/crosser.js\n **/","export default Promise;\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./lib/modules/promise/native-promise.js\n **/","export default function(options){\n\tvar Promise = options.Promise;\n\n\tfunction generateId() {\n\t\treturn new Date().getTime().toString();\n\t}\n\n\tclass Crosser {\n\n\t\tconstructor(otherFrameWindow, origin) {\n\t\t\t/* private */\n\t\t\tthis._sessionHandlers = {};\n\t\t\tthis._listeners = {};\n\t\t\tthis._otherFrameWindow = otherFrameWindow;\n\t\t\tthis._otherOrigin = origin || '*';\n\t\t\tthis._id = generateId();\n\t\t\tthis._events = {};\n\n\t\t\tif (!this._otherFrameWindow || !this._otherFrameWindow.postMessage) {\n\t\t\t\tthrow new Error('Missing frame to communicate with');\n\t\t\t}\n\n\t\t\twindow.addEventListener(\"message\", this.receiveMessage.bind(this), false);\n\t\t}\n\n\t\treceiveMessage(event) {\n\t\t\tvar message = event.data,\n\t\t\t\tdoesOriginMatch = this.doesOriginMatch(event.origin);\n\n\t\t\tif (!doesOriginMatch || !message) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (message.type === 'event') {\n\t\t\t\tif (message.eventName && this._events[message.eventName]) {\n\t\t\t\t\tthis.fireEvent(event);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (message.sessionName &&\n\t\t\t\t\tthis._sessionHandlers[message.sessionName] &&\n\t\t\t\t\tmessage.creator === this._id) {\n\n\t\t\t\t\tthis.endSession(event);\n\t\t\t\t} else if (\n\t\t\t\t\tmessage.sessionName &&\n\t\t\t\t\tmessage.creator !== this._id) {\n\n\t\t\t\t\tthis.throwBackSession(event);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tdoesOriginMatch(eventOrigin) {\n\t\t\tvar ret =\n\t\t\t\t(\n\t\t\t\t\teventOrigin === this._otherOrigin ||\n\t\t\t\t\t(\n\t\t\t\t\t\tthis._otherOrigin === '*' &&\n\t\t\t\t\t\twindow.location.origin === eventOrigin\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\treturn ret;\n\t\t}\n\n\t\tendSession(event) {\n\t\t\tvar message = event.data;\n\t\t\tvar resolve = this._sessionHandlers[message.sessionName].resolve;\n\t\t\tvar reject = this._sessionHandlers[message.sessionName].reject;\n\n\t\t\tthis.deleteSession(message.sessionName);\n\n\t\t\tif (message.error) {\n\t\t\t\treject(message.error);\n\t\t\t} else {\n\t\t\t\tresolve(message.payload);\n\t\t\t}\n\t\t}\n\n\t\tthrowBackSession(event) {\n\t\t\tvar message = event.data,\n\t\t\t\tsessionName = message.sessionName;\n\n\t\t\tObject.keys(this._listeners[sessionName] || {}).forEach(function(subscriberId) {\n\t\t\t\tvar callbackResult = this._listeners[sessionName][subscriberId](message.payload);\n\t\t\t\tif (callbackResult && callbackResult.then) {\n\t\t\t\t\tcallbackResult.then(function(resolvedPayload) {\n\t\t\t\t\t\tthis.postMessage({\n\t\t\t\t\t\t\tsessionName: sessionName,\n\t\t\t\t\t\t\tpayload: resolvedPayload,\n\t\t\t\t\t\t\tcreator: message.creator\n\t\t\t\t\t\t});\n\t\t\t\t\t}.bind(this));\n\t\t\t\t} else {\n\t\t\t\t\tthis.postMessage({\n\t\t\t\t\t\tsessionName: sessionName,\n\t\t\t\t\t\tpayload: callbackResult,\n\t\t\t\t\t\tcreator: message.creator\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}, this);\n\n\t\t}\n\n\t\tpostMessage(message) {\n\t\t\tthis._otherFrameWindow.postMessage(message, this._otherOrigin);\n\t\t}\n\n\t\tdeleteSession(sessionName) {\n\t\t\tthis._sessionHandlers[sessionName].resolve = null;\n\t\t\tdelete this._sessionHandlers[sessionName].resolve;\n\t\t\tthis._sessionHandlers[sessionName].reject = null;\n\t\t\tdelete this._sessionHandlers[sessionName].reject;\n\t\t\tthis._sessionHandlers[sessionName] = null;\n\t\t\tdelete this._sessionHandlers[sessionName];\n\t\t}\n\n\t\tdestroy() {\n\t\t\tObject.keys(this._listeners || {}).forEach(this.unsubscribe, this);\n\t\t\tObject.keys(this._sessionHandlers || {}).forEach(this.deleteSession, this);\n\t\t\tthis._otherFrameWindow = null;\n\t\t\tthis._otherOrigin = null;\n\t\t\tthis._id = null;\n\t\t}\n\n\t\ttrigger(sessionName, payload) {\n\t\t\tvar promise;\n\n\t\t\tif (this._sessionHandlers[sessionName]) {\n\t\t\t\tthrow new Error('A session with the name ' + sessionName + ' is still alive');\n\t\t\t}\n\n\t\t\tpromise = new Promise(function(resolve, reject) {\n\t\t\t\tthis._sessionHandlers[sessionName] = {\n\t\t\t\t\tresolve: resolve,\n\t\t\t\t\treject: reject\n\t\t\t\t};\n\t\t\t}.bind(this));\n\n\t\t\tthis.postMessage({\n\t\t\t\tsessionName: sessionName,\n\t\t\t\tpayload: payload,\n\t\t\t\tcreator: this._id\n\t\t\t});\n\n\t\t\treturn promise;\n\t\t}\n\n\t\tabort(sessionName) {\n\t\t\tthis.deleteSession(sessionName);\n\t\t}\n\n\t\tsubscribe(sessionName, callback) {\n\t\t\tvar subscriberId = generateId();\n\n\t\t\tthis._listeners[sessionName] = this._listeners[sessionName] || {};\n\t\t\tif (Object.keys(this._listeners[sessionName] || {}).length > 0) {\n\t\t\t\tthrow new Error('A session ( ' + sessionName + ' ) can have only one subscriber');\n\t\t\t}\n\n\t\t\tthis._listeners[sessionName][subscriberId] = callback;\n\t\t\treturn subscriberId;\n\t\t}\n\n\t\tunsubscribe(sessionName, subscriberId) {\n\t\t\tif (!subscriberId) {\n\t\t\t\tObject.keys(this._listeners[sessionName] || {}).forEach(this.unsubscribe.bind(this, sessionName));\n\t\t\t} else {\n\t\t\t\tthis._listeners[sessionName][subscriberId] = null;\n\t\t\t\tdelete this._listeners[sessionName][subscriberId];\n\t\t\t}\n\t\t}\n\n\t\tfireEvent(event) {\n\t\t\tvar message = event.data;\n\n\t\t\tthis._events[message.eventName].forEach(function(callback) {\n\t\t\t\tcallback(message.payload);\n\t\t\t});\n\t\t}\n\n\t\tsubscribeEvent(eventName, callback) {\n\t\t\tthis._events[eventName] = this._events[eventName] || [];\n\t\t\tthis._events[eventName].push(callback);\n\t\t}\n\n\t\tunsubscribeEvent(eventName) {\n\t\t\tthis._events[eventName] = null;\n\t\t\tdelete this._events[eventName];\n\t\t}\n\n\t\ttriggerEvent(eventName, payload) {\n\t\t\tthis.postMessage({\n\t\t\t\teventName: eventName,\n\t\t\t\ttype: 'event',\n\t\t\t\tpayload: payload,\n\t\t\t\tcreator: this._id\n\t\t\t});\n\t\t}\n\t}\n\n\treturn Crosser;\n\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./~/eslint-loader!./lib/modules/crosser/get-crosser-class.js\n **/"],"sourceRoot":""}